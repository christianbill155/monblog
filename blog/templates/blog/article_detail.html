{% extends 'blog/base.html' %}
{% load static %}

{% block title %}{{ article.titre }} - Mon Blog{% endblock %}

{% block content %}
<article class="article-detail">
    <div class="container">
        <div class="article-header">
            <div class="article-meta">
                <span class="article-date">{{ article.published_date }}</span>
                {% if article.author %}
                <span class="article-author">par {{ article.author }}</span>
                {% endif %}
            </div>
            <h1 class="article-title">{{ article.title }}</h1>
            {% if article.tags %}
            <div class="article-tags">
                {% for tag in article.tags.all %}
                <span class="tag">{{ tag.name }}</span>
                {% endfor %}
            </div>
            {% endif %}
        </div>
        
        <div class="article-content">
            {{ article.content|linebreaks }}
        </div>
        
        <div class="article-actions">
            <a href="{% url 'article_list' %}" class="btn btn-secondary">← Retour aux articles</a>
            {% if user.is_authenticated and user == article.author %}
            <div class="action-buttons">
                <a href="#" class="btn btn-outline">Modifier</a>
                <a href="#" class="btn btn-danger">Supprimer</a>
            </div>
            {% endif %}
        </div>
        
        <!-- Section commentaires -->
        <section class="comments-section">
            <h2>Commentaires ({{ article.commentaires.count }})</h2>
            
            {% if user.is_authenticated %}
            <div class="comment-form">
                <h3>Laisser un commentaire</h3>
                <form method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <textarea name="contenu" rows="4" placeholder="Votre commentaire..." required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Publier</button>
                </form>
            </div>
            {% else %}
            <div class="auth-prompt">
                <p>Vous devez être connecté pour commenter.</p>
                <a href="{% url 'login' %}" class="btn btn-primary">Se connecter</a>
            </div>
            {% endif %}
            
            <div class="comments-list">
                {% for commentaire in article.commentaires.all %}
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">{{ commentaire.auteur.username }}</span>
                        <span class="comment-date">{{ commentaire.date_creation|date:"d M Y à H:i" }}</span>
                    </div>
                    <div class="comment-content">
                        {{ commentaire.contenu|linebreaks }}
                    </div>
                </div>
                {% empty %}
                <div class="no-comments">
                    <p>Soyez le premier à commenter cet article!</p>
                </div>
                {% endfor %}
            </div>
        </section>
    </div>
</article>
{% endblock %}